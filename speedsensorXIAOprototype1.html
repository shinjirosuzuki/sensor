<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>BLE TEST</title>
</head>
<body>
    <button id="connect" style="font-size: 30px; padding: 20px;">1. 接続テスト開始</button>
    <div id="status" style="font-size: 20px; margin-top: 20px;">ステータス: 待機中</div>

    <script>
        document.getElementById('connect').addEventListener('click', async () => {
            const status = document.getElementById('status');
            status.innerText = "スキャン中...";
            
            try {
                // 1. デバイスを探す
                const device = await navigator.bluetooth.requestDevice({
                    filters: [{ namePrefix: 'XIAO' }],
                    optionalServices: ['1234']
                });
                
                status.innerText = "接続中: " + device.name;
                
                // 2. サーバーに接続
                const server = await device.gatt.connect();
                status.innerText = "サービス取得中...";
                
                // 3. サービス取得
                const service = await server.getPrimaryService('1234');
                status.innerText = "接続成功！";
                alert("XIAOとつながりました！");
                
            } catch (error) {
                console.error(error);
                status.innerText = "エラー: " + error.message;
                alert("エラー詳細: " + error.message);
            }
        });
    </script>
</body>
</html>
